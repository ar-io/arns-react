import{r as o,g as le,k as ce,f as Y,j as e,a_ as de,bJ as pe,a$ as xe,bK as ue,bf as me,b as he,T as M,bL as re,bM as ae,bN as se,bo as H,bO as ge,bP as be,bQ as we,bR as ye,bS as ve,bT as Ne,e as Se,u as je,bU as Ie,c as ke,be as Ae,bV as Te,bW as Ee,m as Ce,bX as Re,bY as b,bZ as ne,b_ as oe,b$ as Pe,c0 as Le,c1 as De,c2 as Be,c3 as $e,bh as Oe,c4 as ie}from"./index-1de0d2a6.js";import{C as Ve}from"./Counter-d3dc2afd.js";import{P as _e}from"./Pagination-40fb5f04.js";(function(){try{var d=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},N=new Error().stack;N&&(d._sentryDebugIds=d._sentryDebugIds||{},d._sentryDebugIds[N]="5c362804-d3cb-451b-5cfb-d56fc5b05b18",d._sentryDebugIdIdentifier="sentry-dbid-5c362804-d3cb-451b-5cfb-d56fc5b05b18")}catch{}})();function fe(d){const[N,j]=o.useState(!1);return o.useEffect(()=>{if(!d)return;const w=document.getElementById(d);if(!w){console.error(`No element found with id: ${d}`);return}const T=()=>j(!0),f=()=>j(!1);return w.addEventListener("focus",T),w.addEventListener("blur",f),()=>{w.removeEventListener("focus",T),w.removeEventListener("blur",f)}},[d]),N}function ze({selectedTokenCallback:d}){var U;const[{arweaveDataProvider:N,antAoClient:j,hyperbeamUrl:w}]=le(),[{walletAddress:T}]=ce(),[f,i]=o.useState(),[l,x]=o.useState(),[L,V]=o.useState(!1),[n,h]=o.useState(),[m,D]=o.useState(void 0),[J,E]=o.useState(!1),[I,B]=o.useState(!1),[_,z]=o.useState(void 0),X=fe("name-token-input"),y=o.useRef(null),[k,S]=o.useState(1),A=3;o.useEffect(()=>{d(m?new Y(m.id):void 0),S(1)},[m]),o.useEffect(()=>{if(y.current)return document.addEventListener("click",C),()=>{document.removeEventListener("click",C)}},[y]);function C(t){y.current&&t.target!==y.current&&!y.current.contains(t.target)&&(i(""),B(!1),h(void 0),S(1))}async function R(t,a=[]){try{if(V(!0),!t)throw new Error("No address provided");const s=[],c=a.length?await Promise.all(a.map(async r=>{try{const u=ae.init({hyperbeamUrl:w,process:new se({processId:r.toString(),ao:j})}),O=await u.getInfo();if(!u||!O)throw new Error("Unable to get contract");return z(!0),r}catch(u){H.emit("error",u)}})).then(r=>r.filter(u=>!!u)):[];if(!s.length&&!c.length)return;const p=s.concat(c),g=await N.getRecords({filters:{processId:p}}),v=await Promise.all(p.map(async r=>{const u=ae.init({hyperbeamUrl:w,process:new se({processId:r.toString(),ao:j})}),O=Object.keys(g).reduce((W,te)=>(g[te].processId===r.toString()&&(W[te]=g[te]),W),{}),[K,Z,q,ee]=await Promise.all([u.getOwner(),u.getControllers(),u.getTicker(),u.getName()]).catch(()=>{throw new Error("Unable to get contract details")});return{processId:r,names:O,owner:K,controllers:Z,ticker:q,name:ee}})).then(r=>r.filter(u=>!!u));if(!v.length)throw new Error("Unable to get details for Name Tokens");const P=v.reduce(async(r,u)=>{const{processId:O,owner:K,controllers:Z,name:q,ticker:ee,names:W}=u;return{...r,[O.toString()]:{owner:K,controllers:Z,name:q,ticker:ee,names:Object.keys(W)}}},{});if(x(await P),c.length){const r=P[c[0].toString()];D({name:r==null?void 0:r.name,ticker:r==null?void 0:r.ticker,id:c[0].toString(),names:(r==null?void 0:r.names)??[]})}}catch(s){H.emit("error",s)}finally{V(!1),S(1)}}function G(t){try{if(E(!0),z(void 0),!t){i("");return}if(i(t),!l)throw new Error("No Name Tokens Found");const a=Object.keys(l).filter(s=>{const{owner:c,controllers:p,name:g,ticker:v}=l[s];return[c,p,g,v,s].some(r=>r&&r.toString().toLowerCase().includes(t.toLowerCase()))}).map(s=>{const{name:c,ticker:p,names:g}=l[s];return{id:s,name:c??"",ticker:p??"",names:g}}).filter(s=>!!s);if(!a.length)throw new Error("No ANT tokens found for that search");h(a)}catch{h(void 0)}finally{E(!1),S(1)}}function F({id:t,name:a,ticker:s,names:c}){try{if(i(""),h(void 0),t===void 0)throw new Error(`No ID provided for ${a??s??""}`);D({id:t,name:a??"",ticker:s??"",names:c}),d(new Y(t)),S(1)}catch(p){H.emit("error",p)}finally{B(!1)}}const Q=(t,a,s)=>{if(l&&!(a==="next"||a==="prev"))return a==="page"?e.jsx("span",{className:"flex flex-row hover center",style:{color:k===t?"white":"var(--text-grey)",width:"32px"},children:t}):s};function $(t){S(t)}return e.jsxs("div",{ref:y,className:"flex flex-column radius",style:{position:"relative",height:"fit-content",maxHeight:"400px",border:X||I?"1px solid var(--text-white)":"1px solid var(--text-faded)",gap:0,boxSizing:"border-box"},children:[e.jsxs("div",{className:"name-token-input-wrapper",style:{borderBottom:"1px solid var(--text-faded)"},children:[e.jsx(de,{inputId:"name-token-input",onClick:()=>B(!0),showValidationIcon:!0,setValue:t=>G(t),value:f??"",maxCharLength:pe,placeholder:m?(U=m.name)!=null&&U.length?m.name:m.id:"Add an Arweave Name Token (ANT)",validationPredicates:{[xe.ARWEAVE_ID]:{fn:t=>N.validateArweaveId(t)}},validityCallback:t=>t,wrapperCustomStyle:{width:"100%",hieght:"45px",borderRadius:"0px",backgroundColor:"var(--card-bg)",boxSizing:"border-box",paddingLeft:"10px"},inputClassName:`white ${m?"name-token-input-selected":"name-token-input"}`}),e.jsx("span",{className:`flex flex-row text grey flex-center ${m?"bold":""} hover`,style:{width:"fit-content",height:"fit-content",wordBreak:"keep-all"},children:L||J?e.jsx(ue,{size:20,color:"var(--text-white)"}):f&&_===!1?e.jsx(e.Fragment,{}):f&&me(f)&&!Object.keys(l??[]).includes(f)?e.jsx("button",{className:"outline-button flex flex-row center pointer",style:{borderRadius:"50px",width:"fit-content",padding:"3px 6px",fontSize:"12px",minWidth:"fit-content",border:"1px solid var(--text-grey)"},onClick:()=>{R(T,[new Y(f)])},children:"Import"}):m?e.jsxs("button",{className:"outline-button flex flex-row center pointer",style:{gap:"3px",borderRadius:"50px",width:"fit-content",padding:"3px 7px",fontSize:"12px",minWidth:"fit-content",border:"1px solid var(--text-grey)"},onClick:()=>{D(void 0),d(void 0)},children:[e.jsx(he,{width:"13px",height:"13px"}),"Remove"]}):e.jsx(M,{message:"For advanced use cases only, you can register this name with a custom ANT by entering its Process ID."})})]}),l&&I?e.jsxs("div",{className:"flex flex-column",style:{alignItems:"flex-start",justifyContent:"flex-start",gap:0,height:"fit-content",width:"100%",backgroundColor:"var(--card-bg)",boxSizing:"border-box",zIndex:10},children:[f&&!(n!=null&&n.length)?e.jsx("span",{className:"text-large center",style:{color:"#444547",margin:"auto",height:"50px"},children:"No Results"}):n?n.slice(Math.max((k-1)*A,0),k*A).map((t,a)=>{var s;if(t)return e.jsxs("button",{className:"name-token-item pointer",onClick:()=>{F({id:t.id,name:t.name??"",ticker:t.ticker??"",names:t.names??[]})},children:[t.name&&t.ticker?`${t.name.slice(0,20)} (${t.ticker}) - ${t.id}`:t.id,(s=t.names)!=null&&s.length?e.jsx(M,{icon:e.jsx(re,{width:20,height:20,fill:"var(--text-grey)"}),message:e.jsx("div",{className:"flex flex-column",style:{padding:"5px",gap:"5px",boxSizing:"border-box"},children:t.names.map(c=>e.jsx("span",{children:c},c))})},a):e.jsx(e.Fragment,{})]},a)}):Object.entries(l).slice(Math.max((k-1)*A,0),k*A).map((t,a)=>{if(!t)return;const[s,c]=t,{name:p,ticker:g,names:v}=c;return e.jsxs("button",{className:"name-token-item pointer",onClick:()=>{F({id:s,name:p??"",ticker:g??"",names:v??[]})},children:[p&&g?`${p.slice(0,20)} ${p.length>20?"...":""} (${g}) - ${s}`:s,v!=null&&v.length?e.jsx(M,{icon:e.jsx(re,{width:20,height:20,fill:"var(--text-grey)"}),message:e.jsx("div",{className:"flex flex-column",style:{padding:"5px",boxSizing:"border-box"},children:v.map(P=>e.jsx("span",{children:P},P))})}):e.jsx(e.Fragment,{})]},a)}),e.jsxs("div",{className:"custom-next-pagination flex flex-column",style:{padding:"10px 25px",boxSizing:"border-box",width:"100%",justifyContent:"flex-start"},children:[l.length||n!=null&&n.length||!f?e.jsx(_e,{total:Object.keys(l).length&&!n?Object.keys(l).length:n?n.length:0,itemRender:Q,showPrevNextJumpers:!0,showSizeChanger:!1,showQuickJumper:!1,onChange:$,current:k,defaultPageSize:A}):e.jsx(e.Fragment,{})," "]})]}):e.jsx(e.Fragment,{})]})}function Ye(){const[{arweaveDataProvider:d,arioTicker:N,arioProcessId:j,antAoClient:w,antRegistryProcessId:T,hyperbeamUrl:f}]=le(),[{domain:i,leaseDuration:l,registrationType:x,antID:L,targetId:V},n]=ge(),{data:h}=be({intent:"Buy-Name",name:i,type:x,years:l}),{data:m}=we({intent:"Buy-Name",name:i,type:x,years:l}),D=o.useMemo(()=>!m||!h?"Calculating prices...":`Cost: $${ye(m.fiatEstimate.paymentAmount/100)} USD ( ${ve(new Ne(h.tokenCost).toARIO().valueOf())} ${N} )`,[m,h]),[{walletAddress:J}]=ce(),[,E]=Se(),{name:I}=je(),{isLoading:B}=Ie(I??i),[_,z]=o.useState(),X=fe("target-id-input"),y=ke(),[k,S]=o.useState(!1),[A,C]=o.useState(!1),{data:R,isRefetching:G,isLoading:F,refetch:Q}=Ae(),$=o.useMemo(()=>R==null?void 0:R.moduleId,[R]);o.useEffect(()=>{I&&i!==I&&n({type:"setDomainName",payload:I})},[I,i]);async function U(a){if(!a){n({type:"setANTID",payload:void 0});return}if(n({type:"setANTID",payload:a}),!ae.init({hyperbeamUrl:f,process:new se({processId:a.toString(),ao:w})}))throw new Error("Contract not found")}if(!x)return e.jsx(ue,{size:80});async function t(){try{if(!J){y("/connect",{state:{to:`/register/${i}`,from:`/register/${i}`}});return}if(!$&&(await Q(),!$))throw new Error("No ANT Module available, try again later");if(C(!0),k)throw new Be("Please fix the errors above before continuing.")}catch(c){H.emit("error",c),C(!1);return}finally{C(!1)}const s={name:i&&$e().test(i)?Oe(i):i,processId:L==null?void 0:L.toString(),years:x===b.LEASE?l:void 0,type:x,targetId:V,antModuleId:$,antRegistryId:T};E({type:"setTransactionData",payload:{assetId:j,functionName:"buyRecord",...s,interactionPrice:h==null?void 0:h.tokenCost}}),E({type:"setInteractionType",payload:ie.BUY_RECORD}),E({type:"setWorkflowName",payload:ie.BUY_RECORD}),y("/checkout",{state:`/register/${i}`})}return e.jsxs("div",{className:"page",children:[e.jsx(Te,{message:"Loading Domain info, please wait.",loading:B||G||F}),e.jsxs("div",{className:"flex flex-column flex-center",style:{maxWidth:"900px",width:"100%",padding:"0px",gap:"50px",boxSizing:"border-box"},children:[e.jsx("div",{className:"flex flex-row flex-center",style:{paddingBottom:"20px",borderBottom:"solid 1px var(--text-faded)"},children:e.jsx(Ee,{stages:[{title:"Choose",description:"Pick a name",status:"finish"},{title:"Configure",description:"Registration Period",status:"process"},{title:"Confirm",description:"Review transaction",status:"wait"}],stage:1})}),e.jsxs("span",{className:"text-medium white center",style:{fontWeight:"500px",fontSize:"23px",gap:"15px"},children:[e.jsxs("span",{style:{color:"var(--success-green)"},children:[Ce(i)," ",e.jsx("span",{className:"white",children:"is available!"})]})," ",e.jsx(Re,{style:{fontSize:"20px",color:"var(--success-green)"}})]}),e.jsxs("div",{className:"flex flex-column flex-center",children:[e.jsxs("div",{className:"flex flex-column flex-center",style:{width:"100%",height:"fit-content",gap:"15px"},children:[e.jsxs("div",{className:"flex flex-row flex-space-between",style:{gap:"25px"},children:[e.jsxs("button",{className:"flex flex-row center text-medium bold pointer",onClick:()=>n({type:"setRegistrationType",payload:b.LEASE}),style:{position:"relative",background:x===b.LEASE?"var(--text-white)":"",color:x===b.LEASE?"var(--text-black)":"var(--text-white)",border:"solid 2px var(--text-faded)",borderRadius:"var(--corner-radius)",height:"56px",borderBottomWidth:"0.5px"},children:["Lease"," ",x===b.LEASE?e.jsx("div",{style:{position:"absolute",bottom:"-6px",left:"50%",transform:"rotate(45deg)",width:"11px",height:"11px",background:"var(--text-white)"}}):e.jsx(e.Fragment,{})]}),e.jsxs("button",{className:"flex flex-row center text-medium bold pointer",style:{position:"relative",background:x===b.BUY?"var(--text-white)":"",color:x===b.BUY?"var(--text-black)":"var(--text-white)",border:"solid 2px var(--text-faded)",borderRadius:"var(--corner-radius)",height:"56px",borderBottomWidth:"0.5px"},onClick:()=>n({type:"setRegistrationType",payload:b.BUY}),children:["Buy"," ",x===b.BUY?e.jsx("div",{style:{position:"absolute",bottom:-6,left:"50%",transform:"rotate(45deg)",width:"11px",height:"11px",background:"var(--text-white)"}}):e.jsx(e.Fragment,{})]})]}),e.jsx("div",{className:"flex flex-column flex-center card",style:{width:"100%",minHeight:"0px",height:"fit-content",maxWidth:"unset",padding:"25px",boxSizing:"border-box",borderTopWidth:"0.2px",borderRadius:"var(--corner-radius)",justifyContent:"flex-start"},children:x===b.LEASE?e.jsx(Ve,{value:l,setValue:a=>{n({type:"setLeaseDuration",payload:a})},minValue:ne,maxValue:oe,valueStyle:{padding:"20px 120px"},valueName:l>1?"years":"year",detail:`Until ${Pe(Date.now()+l*365*24*60*60*1e3)}`,title:e.jsx("span",{className:"white",style:{padding:"0px 10px 10px 10px",fontWeight:"500"},children:`Registration period (between ${ne}-${oe} years)`})}):x===b.BUY?e.jsxs("div",{className:"flex flex-column flex-center",style:{gap:"1em"},children:[e.jsx("span",{className:"text-medium grey center",children:"Registration Period"}),e.jsx("span",{className:"text-medium white center",children:"Permanent"})]}):e.jsx(e.Fragment,{})})]}),e.jsxs("div",{className:"flex flex-column",style:{gap:"1em"},children:[e.jsx(Le,{title:e.jsx("span",{className:"text-medium",children:"Advanced Options"}),children:e.jsxs("div",{className:"flex flex-column",style:{gap:"1em"},children:[e.jsxs("div",{className:"name-token-input-wrapper",style:{border:X||_?"solid 1px var(--text-white)":"solid 1px var(--text-faded)",position:"relative"},children:[e.jsx(de,{inputId:"target-id-input",value:_??"",setValue:a=>{z(a.trim()),me(a.trim())&&n({type:"setTargetId",payload:new Y(a.trim())}),a.trim().length===0&&S(!1)},wrapperCustomStyle:{width:"100%",hieght:"45px",borderRadius:"0px",backgroundColor:"var(--card-bg)",boxSizing:"border-box"},inputClassName:"white name-token-input",inputCustomStyle:{paddingLeft:"10px",background:"transparent"},maxCharLength:43,placeholder:"Arweave Transaction ID (Target ID)",validationPredicates:{[xe.ARWEAVE_ID]:{fn:a=>d.validateArweaveId(a)}},showValidationChecklist:!1,showValidationIcon:!0,validityCallback:a=>{S(!a)}}),e.jsx("span",{className:"flex flex-row text grey flex-center",style:{width:"fit-content",height:"fit-content",wordBreak:"keep-all"},children:e.jsx(M,{message:"The Target ID is the Arweave Transaction ID that will be resolved at the root of this ArNS name"})})]}),e.jsx(ze,{selectedTokenCallback:a=>U(a)})]})},"1"),e.jsx("div",{className:"text-white flex w-full items-center justify-end pb-4 border-b border-dark-grey whitespace-nowrap",children:D}),e.jsx("div",{style:{marginTop:"0px"},children:e.jsx(De,{nextText:"Next",backText:"Back",onNext:A?void 0:t,onBack:()=>{n({type:"reset"}),y("/",{state:`/register/${i}`})},customBackStyle:{fontSize:".875rem",padding:".625rem"},customNextStyle:{width:"100px",fontSize:".875rem",padding:".625rem"}})})]})]})]})]})}export{Ye as default};
//# sourceMappingURL=Register-1f463163.js.map
