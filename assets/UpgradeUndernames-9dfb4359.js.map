{"version":3,"file":"UpgradeUndernames-9dfb4359.js","sources":["../../src/components/layout/UpgradeUndernames/UpgradeUndernames.tsx"],"sourcesContent":["import { mARIOToken } from '@ar.io/sdk/web';\nimport { useArNSIntentPrice } from '@src/hooks/useArNSIntentPrice';\nimport { useCostDetails } from '@src/hooks/useCostDetails';\nimport useDomainInfo from '@src/hooks/useDomainInfo';\nimport { useMemo, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\n\nimport { useIsMobile } from '../../../hooks';\nimport { useGlobalState } from '../../../state/contexts/GlobalState';\nimport { useTransactionState } from '../../../state/contexts/TransactionState';\nimport {\n  ARNS_INTERACTION_TYPES,\n  IncreaseUndernamesPayload,\n} from '../../../types';\nimport {\n  formatARIO,\n  formatARIOWithCommas,\n  lowerCaseDomain,\n} from '../../../utils';\nimport Counter from '../../inputs/Counter/Counter';\nimport WorkflowButtons from '../../inputs/buttons/WorkflowButtons/WorkflowButtons';\nimport Loader from '../Loader/Loader';\n\nfunction UpgradeUndernames() {\n  const isMobile = useIsMobile();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const [{ arioTicker, arioProcessId }] = useGlobalState();\n  const name = location.pathname.split('/').at(-2);\n  const [, dispatchTransactionState] = useTransactionState();\n  const [newUndernameCount, setNewUndernameCount] = useState<number>(0);\n  const { data: domainData } = useDomainInfo({ domain: name });\n\n  const { data: costDetails, isLoading: loadingCostDetails } = useCostDetails({\n    intent: 'Increase-Undername-Limit',\n    quantity: newUndernameCount,\n    name: name as string,\n  });\n  const { data: fiatFee, isLoading: loadingFiatFee } = useArNSIntentPrice({\n    intent: 'Increase-Undername-Limit',\n    name: name as string,\n    increaseQty: newUndernameCount,\n  });\n  const arioFee = costDetails?.tokenCost\n    ? new mARIOToken(costDetails.tokenCost).toARIO().valueOf()\n    : undefined;\n\n  const feeString = useMemo(() => {\n    if (newUndernameCount === 0) {\n      return `$0 USD ( 0 ${arioTicker} )`;\n    }\n    if (loadingCostDetails || loadingFiatFee) {\n      return `Calculating price...`;\n    }\n    if (arioFee && fiatFee) {\n      return `$${formatARIOWithCommas(\n        fiatFee.fiatEstimate.paymentAmount / 100,\n      )} USD ( ${formatARIO(arioFee)} ${arioTicker} )`;\n    }\n    return `Unable to calculate price`;\n  }, [arioFee, fiatFee, loadingCostDetails, loadingFiatFee, newUndernameCount]);\n\n  const {\n    arnsRecord,\n    antProcess: antContract,\n    undernameCount,\n  } = domainData ?? {};\n  if (!arnsRecord || !antContract || !name) {\n    return (\n      <div className=\"page center\">\n        <Loader size={80} message=\"Loading domain record\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"page center\">\n      <div className=\"flex flex-column\" style={{ maxWidth: '1000px' }}>\n        <h1 className=\"flex white text-[2rem]\">Increase Undernames</h1>\n        <div\n          className=\"flex center\"\n          style={{\n            justifyContent: 'space-between',\n            border: '1px solid var(--text-faded)',\n            padding: '35px 40px',\n            borderRadius: 'var(--corner-radius)',\n            flexDirection: isMobile ? 'column' : 'row',\n            gap: '30px',\n          }}\n        >\n          <div\n            className=\"flex flex-column\"\n            style={{ fontSize: '16px', width: 'fit-content', gap: '5px' }}\n          >\n            <span\n              className=\"flex grey center\"\n              style={{ gap: '8px', whiteSpace: 'nowrap' }}\n            >\n              Total Undernames:{' '}\n              <span className=\"white\">{arnsRecord.undernameLimit}</span>\n              <span className=\"flex add-box center\" style={{}}>\n                +{newUndernameCount}\n              </span>\n            </span>\n            <span className=\"flex grey\">\n              Used:&nbsp;\n              <span className=\"white\"> {undernameCount}</span>\n            </span>\n          </div>\n          <Counter\n            maxValue={Number.MAX_SAFE_INTEGER - 1 - arnsRecord.undernameLimit}\n            minValue={0}\n            value={newUndernameCount}\n            setValue={setNewUndernameCount}\n            containerStyle={{\n              width: 'fit-content',\n              justifyContent: 'center',\n              alignItems: 'center',\n            }}\n            valueStyle={{\n              background: 'var(--card-bg)',\n              width: '50px',\n              height: '40px',\n              alignItems: 'center',\n              justifyContent: 'center',\n              border: '1px solid var(--text-faded)',\n              borderRadius: 'var(--corner-radius)',\n              margin: '0px 10px',\n              fontSize: '14px',\n            }}\n            editable={true}\n          />\n        </div>\n        <span className=\"flex text-white border-b border-dark-grey items-end pb-4 w-full justify-end\">\n          {feeString}\n        </span>\n        <WorkflowButtons\n          backText=\"Cancel\"\n          nextText=\"Confirm\"\n          onBack={() => navigate(`/manage/names/${lowerCaseDomain(name)}`)}\n          onNext={\n            !arioFee || arioFee < 0\n              ? undefined\n              : () => {\n                  const increaseUndernamePayload: IncreaseUndernamesPayload = {\n                    name: lowerCaseDomain(name),\n                    qty: newUndernameCount,\n                    oldQty: arnsRecord.undernameLimit,\n                    processId: arnsRecord.processId,\n                  };\n                  dispatchTransactionState({\n                    type: 'setTransactionData',\n                    payload: {\n                      assetId: arioProcessId,\n                      functionName: 'increaseundernameLimit',\n                      ...increaseUndernamePayload,\n                      interactionPrice: arioFee,\n                    },\n                  });\n                  dispatchTransactionState({\n                    type: 'setInteractionType',\n                    payload: ARNS_INTERACTION_TYPES.INCREASE_UNDERNAMES,\n                  });\n                  dispatchTransactionState({\n                    type: 'setWorkflowName',\n                    payload: ARNS_INTERACTION_TYPES.INCREASE_UNDERNAMES,\n                  });\n                  // navigate to the transaction page, which will load the updated state of the transaction context\n                  navigate(`/checkout`, {\n                    state: `/manage/names/${lowerCaseDomain(\n                      name,\n                    )}/upgrade-undernames`,\n                  });\n                }\n          }\n          customBackStyle={{\n            minWidth: '100px',\n            padding: ' 12px 16px',\n          }}\n          customNextStyle={{\n            minWidth: '100px',\n            padding: ' 12px 16px',\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default UpgradeUndernames;\n"],"names":["UpgradeUndernames","isMobile","useIsMobile","location","useLocation","navigate","useNavigate","arioTicker","arioProcessId","useGlobalState","name","dispatchTransactionState","useTransactionState","newUndernameCount","setNewUndernameCount","reactExports","domainData","useDomainInfo","costDetails","loadingCostDetails","useCostDetails","fiatFee","loadingFiatFee","useArNSIntentPrice","arioFee","xw","feeString","formatARIOWithCommas","formatARIO","arnsRecord","antContract","undernameCount","jsxRuntimeExports","Loader","Counter","WorkflowButtons","lowerCaseDomain","increaseUndernamePayload","ARNS_INTERACTION_TYPES"],"mappings":"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"}